<!DOCTYPE html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Teddy Bear Builder</title>
  <meta name="description" content="Build and customize your own teddy bear. Save, load, export PNG, share, and get smart recommendations." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="brand" aria-label="Brand">
        <div class="brand-badge" aria-hidden="true"></div>
        <div>
          <div style="font-size:1.15rem;">Teddy Bear Builder</div>
          <div style="color:var(--muted); font-size:.9rem;">Craft your cuddly companion</div>
        </div>
      </div>
      <div class="header-actions" role="toolbar" aria-label="Header actions">
        <label class="switch" aria-label="Toggle light or dark theme">
          <input id="theme-toggle" type="checkbox" aria-pressed="false" />
          <span class="track" aria-hidden="true"><span class="thumb"></span></span>
          <span class="visually-hidden">Theme</span>
        </label>
        <button id="btn-save" class="btn" aria-haspopup="dialog" aria-controls="modal-save">Save</button>
        <button id="btn-load" class="btn" aria-haspopup="dialog" aria-controls="modal-load">Load</button>
        <button id="btn-help" class="btn" aria-haspopup="dialog" aria-controls="modal-help">Help</button>
      </div>
    </div>
  </header>

  <main class="container main" id="main-content">
    <!-- LEFT: CONTROLS -->
    <section class="panel" id="controls" aria-label="Customization controls">
      <form id="form-controls">
        <fieldset>
          <legend>Colors</legend>
          <div class="field">
            <label for="color-fur">Fur base</label>
            <input id="color-fur" type="color" value="#C9A27F" aria-describedby="fur-desc">
            <small id="fur-desc" class="visually-hidden">Select the primary fur color</small>
          </div>
          <div class="field">
            <label for="color-inner">Fur secondary (inner ears)</label>
            <input id="color-inner" type="color" value="#E5C8A1">
          </div>
          <div class="field">
            <label for="color-face">Face patch</label>
            <input id="color-face" type="color" value="#F6E2C8">
          </div>
          <div class="field">
            <label for="color-belly">Belly patch</label>
            <input id="color-belly" type="color" value="#F6E2C8">
          </div>
          <div class="field">
            <label for="color-shirt">T-shirt color</label>
            <input id="color-shirt" type="color" value="#FFFFFF">
          </div>
          <div class="field">
            <label for="color-accessory">Accessory accent</label>
            <input id="color-accessory" type="color" value="#FF6B6B">
          </div>
        </fieldset>

        <fieldset>
          <legend>Parts & Styles</legend>
          <div class="field">
            <label><input id="toggle-belly" type="checkbox" checked> Show belly patch</label>
          </div>
          <div class="field">
            <label for="ear-size">Ear size</label>
            <input id="ear-size" type="range" min="0.8" max="1.3" step="0.01" value="1">
          </div>
          <div class="field">
            <label for="mouth-style">Mouth style</label>
            <select id="mouth-style">
              <option value="smile">Smile</option>
              <option value="open">Open</option>
              <option value="uwu">UwU</option>
            </select>
          </div>
          <div class="field">
            <label for="eye-style">Eye style</label>
            <select id="eye-style">
              <option value="round">Round</option>
              <option value="starry">Starry</option>
              <option value="sleepy">Sleepy</option>
            </select>
          </div>
          <div class="field">
            <label for="nose-style">Nose style</label>
            <select id="nose-style">
              <option value="oval">Oval</option>
              <option value="triangle">Triangle</option>
            </select>
          </div>
          <div class="field">
            <label for="pattern-style">Pattern</label>
            <select id="pattern-style">
              <option value="solid">Solid</option>
              <option value="spots">Spots</option>
              <option value="heart">Heart patch</option>
            </select>
          </div>
        </fieldset>

        <fieldset>
          <legend>Accessories</legend>
          <div class="field"><label><input id="acc-bow" type="checkbox" checked> Bow</label></div>
          <div class="field"><label><input id="acc-scarf" type="checkbox"> Scarf</label></div>
          <div class="field"><label><input id="acc-hat" type="checkbox"> Hat</label></div>
          <div class="field"><label><input id="acc-shirt" type="checkbox" checked> T-shirt</label></div>
          <div class="field">
            <label for="shirt-text">T-shirt text (max 12)</label>
            <input id="shirt-text" type="text" maxlength="12" value="HUGS">
          </div>
          <div class="field">
            <label for="shirt-font">Text font</label>
            <select id="shirt-font">
              <option value="rounded">Rounded</option>
              <option value="script">Script</option>
              <option value="pixel">Pixel</option>
            </select>
          </div>
        </fieldset>

        <fieldset>
          <legend>Stickers</legend>
          <div class="field">
            <label><input id="sticker-hearts" type="checkbox" checked> Hearts</label>
            <label style="margin-left:12px;"><input id="sticker-stars" type="checkbox"> Stars</label>
            <label style="margin-left:12px;"><input id="sticker-paw" type="checkbox"> Paw</label>
          </div>
          <div class="field">
            <label for="sticker-intensity">Intensity</label>
            <input id="sticker-intensity" type="range" min="0" max="5" step="1" value="2">
          </div>
        </fieldset>

        <fieldset>
          <legend>Pose & Size</legend>
          <div class="field">
            <label for="size-scale">Size</label>
            <input id="size-scale" type="range" min="0.8" max="1.3" step="0.01" value="1.0">
          </div>
          <div class="field">
            <label>Pose</label>
            <div role="group" aria-label="Pose options">
              <label><input type="radio" name="pose" value="in" checked> Arms in</label>
              <label style="margin-left:12px;"><input type="radio" name="pose" value="out"> Arms out</label>
            </div>
          </div>
        </fieldset>
      </form>
    </section>

    <!-- CENTER: STAGE + SVG -->
    <section class="panel stage-wrap" aria-label="Teddy preview">
      <svg id="teddy-svg" viewBox="0 0 320 360" role="img" aria-label="Live teddy bear preview">
        <!-- Ground shadow -->
        <ellipse cx="160" cy="320" rx="70" ry="18" fill="rgba(0,0,0,0.08)"></ellipse>

        <g id="teddy-root" class="bob">
          <!-- BODY -->
          <g id="body">
            <ellipse cx="160" cy="220" rx="65" ry="80" class="fur-base"></ellipse>
            <g id="belly">
              <ellipse cx="160" cy="240" rx="40" ry="50" class="belly-patch"></ellipse>
            </g>
            <!-- Pattern: spots -->
            <g id="pattern-spots" class="hidden">
              <circle cx="140" cy="210" r="6" fill="rgba(0,0,0,0.08)"></circle>
              <circle cx="180" cy="230" r="5" fill="rgba(0,0,0,0.08)"></circle>
              <circle cx="155" cy="255" r="4.5" fill="rgba(0,0,0,0.1)"></circle>
            </g>
            <!-- Pattern: heart patch -->
            <g id="pattern-heart" class="hidden">
              <path d="M160 220 c 18 -18, 42 8, 0 36 c -42 -28, -18 -54, 0 -36z" fill="rgba(255,107,107,0.35)"></path>
            </g>
          </g>

          <!-- LEGS / FEET -->
          <g id="legs">
            <ellipse cx="132" cy="295" rx="22" ry="16" class="fur-base"></ellipse>
            <ellipse cx="188" cy="295" rx="22" ry="16" class="fur-base"></ellipse>
            <ellipse cx="132" cy="297" rx="12" ry="9" class="fur-secondary"></ellipse>
            <ellipse cx="188" cy="297" rx="12" ry="9" class="fur-secondary"></ellipse>
          </g>

          <!-- ARMS -->
          <g id="arms">
            <g id="arm-left">
              <ellipse cx="104" cy="220" rx="18" ry="32" class="fur-base" transform="rotate(-18 104 220)"></ellipse>
            </g>
            <g id="arm-right">
              <ellipse cx="216" cy="220" rx="18" ry="32" class="fur-base" transform="rotate(18 216 220)"></ellipse>
            </g>
          </g>

          <!-- HEAD -->
          <g id="head">
            <!-- Ears -->
            <g id="ears">
              <g id="ear-left" transform="translate(112,104)">
                <circle r="22" class="fur-base stroke-soft"></circle>
                <circle r="12" class="fur-secondary"></circle>
              </g>
              <g id="ear-right" transform="translate(208,104)">
                <circle r="22" class="fur-base stroke-soft"></circle>
                <circle r="12" class="fur-secondary"></circle>
              </g>
            </g>

            <!-- Head base -->
            <circle cx="160" cy="140" r="44" class="fur-base"></circle>

            <!-- Face patch -->
            <ellipse cx="160" cy="152" rx="28" ry="22" class="face-patch"></ellipse>

            <!-- Eyes -->
            <g id="eyes-round">
              <circle cx="145" cy="138" r="5.5" class="eye-fill"></circle>
              <circle cx="175" cy="138" r="5.5" class="eye-fill"></circle>
              <circle cx="143.8" cy="137" r="1.5" class="eye-sparkle"></circle>
              <circle cx="173" cy="136.6" r="1.5" class="eye-sparkle"></circle>
            </g>
            <g id="eyes-starry" class="hidden" fill="#222">
              <path d="M145 134 l2 3 l3 0 l-2 2 l1 3 l-3 -2 l-3 2 l1 -3 l-2 -2 l3 0 z"></path>
              <path d="M175 134 l2 3 l3 0 l-2 2 l1 3 l-3 -2 l-3 2 l1 -3 l-2 -2 l3 0 z"></path>
            </g>
            <g id="eyes-sleepy" class="hidden">
              <path d="M140 138 q5 6 10 0" class="feature-stroke"></path>
              <path d="M170 138 q5 6 10 0" class="feature-stroke"></path>
            </g>

            <!-- Nose -->
            <g id="nose-oval">
              <ellipse cx="160" cy="152" rx="7" ry="5" fill="#333"></ellipse>
            </g>
            <g id="nose-triangle" class="hidden">
              <path d="M153 152 l14 0 l-7 8 z" fill="#333"></path>
            </g>

            <!-- Mouth -->
            <g id="mouth-smile">
              <path d="M150 162 q10 10 20 0" class="feature-stroke"></path>
            </g>
            <g id="mouth-open" class="hidden">
              <path d="M150 162 q10 10 20 0" class="feature-stroke"></path>
              <ellipse cx="160" cy="166" rx="6" ry="4" fill="#aa3b3b"></ellipse>
            </g>
            <g id="mouth-uwu" class="hidden" stroke="#333" stroke-width="1.5" fill="none" stroke-linecap="round">
              <path d="M151 164 q-3 4 0 7" />
              <path d="M169 164 q3 4 0 7" />
              <path d="M154 171 q6 4 12 0" />
            </g>

            <!-- Accessories on head/neck -->
            <g id="accessory-bow" class="accessory">
              <g transform="translate(160,178)">
                <circle cx="0" cy="0" r="5" fill="currentColor"></circle>
                <path d="M-5 0 c-8 -10, -18 2, -2 6 z" fill="currentColor"></path>
                <path d="M5 0 c8 -10, 18 2, 2 6 z" fill="currentColor"></path>
              </g>
            </g>
            <g id="accessory-scarf" class="hidden accessory">
              <rect x="130" y="170" width="60" height="10" rx="5" ry="5" fill="currentColor"></rect>
              <path d="M180 180 q-8 20 -18 30" stroke="currentColor" stroke-width="8" fill="none" stroke-linecap="round"></path>
            </g>
            <g id="accessory-hat" class="hidden accessory">
              <rect x="138" y="98" width="44" height="8" rx="4" ry="4" fill="currentColor"></rect>
              <path d="M150 72 h20 v28 h-20 z" fill="currentColor"></path>
              <circle cx="160" cy="70" r="4" fill="currentColor"></circle>
            </g>
          </g>

          <!-- T-SHIRT -->
          <g id="shirt-group">
            <path id="shirt" class="shirt shirt-stroke" d="M120 210 q40 -20 80 0 v28 q0 16 -40 20 q-40 -4 -40 -20 z"></path>
            <text id="shirt-text-node" x="160" y="232" text-anchor="middle" fill="var(--shirt-text-color)" style="font-size:16px; font-weight:700;">HUGS</text>
          </g>

          <!-- STICKERS -->
          <g id="stickers"></g>
        </g>
      </svg>
    </section>

    <!-- RIGHT: RECOMMENDATIONS -->
    <aside class="panel" aria-label="Recommendations">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
        <h3 style="margin:0;">Smart Recommendations</h3>
        <button id="apply-all" class="btn">Apply All</button>
      </div>
      <div id="chips" class="chips" aria-live="polite" aria-relevant="additions"></div>
    </aside>
  </main>

  <footer class="footer">
    <div class="container footer-inner">
      <div class="footer-actions" role="toolbar" aria-label="Footer actions">
        <button id="btn-randomize" class="btn">Randomize</button>
        <button id="btn-reset" class="btn">Reset</button>
        <button id="btn-export" class="btn">Export PNG</button>
        <button id="btn-share" class="btn">Share</button>
        <button id="btn-cart" class="btn success">Add to Cart</button>
      </div>
      <div id="build-summary" class="summary-line" aria-live="polite">Warm neutral bear · Round eyes · Smile · Bow · Tee: “HUGS”</div>
    </div>
  </footer>

  <!-- SAVE MODAL -->
  <div class="modal-backdrop" id="modal-save" role="dialog" aria-modal="true" aria-labelledby="save-title">
    <div class="modal" role="document">
      <header>
        <h3 id="save-title" style="margin:0;">Save Build</h3>
        <button class="btn" data-close="#modal-save" aria-label="Close save dialog">Close</button>
      </header>
      <div class="field">
        <label for="save-name">Name this build</label>
        <input id="save-name" type="text" maxlength="30" placeholder="e.g., Cozy Bear">
      </div>
      <footer>
        <button class="btn primary" id="save-confirm">Save</button>
      </footer>
    </div>
  </div>

  <!-- LOAD MODAL -->
  <div class="modal-backdrop" id="modal-load" role="dialog" aria-modal="true" aria-labelledby="load-title">
    <div class="modal" role="document">
      <header>
        <h3 id="load-title" style="margin:0;">Load Build</h3>
        <button class="btn" data-close="#modal-load" aria-label="Close load dialog">Close</button>
      </header>
      <div id="load-list" class="list" role="list"></div>
      <footer>
        <button class="btn" data-close="#modal-load">Done</button>
      </footer>
    </div>
  </div>

  <!-- HELP MODAL -->
  <div class="modal-backdrop" id="modal-help" role="dialog" aria-modal="true" aria-labelledby="help-title">
    <div class="modal" role="document">
      <header>
        <h3 id="help-title" style="margin:0;">How to Use Teddy Bear Builder</h3>
        <button class="btn" data-close="#modal-help" aria-label="Close help dialog">Close</button>
      </header>
      <div style="display:grid; gap:10px;">
        <p>
          Use the left panel to customize colors, parts, accessories, stickers, and pose. Everything updates live in the center preview.
          The right panel offers suggestions apply them individually or all at once.
        </p>
        <ul>
          <li>Save and Load builds from the header using local slots.</li>
          <li>Randomize tries pleasant combos with readable T-shirt text.</li>
          <li>Export PNG creates a transparent image at 2× scale.</li>
          <li>Share uses your device’s share sheet; otherwise it copies build JSON.</li>
          <li>All controls are keyboard-accessible with visible focus and ARIA labels.</li>
        </ul>
      </div>
      <footer>
        <button class="btn" data-close="#modal-help">Got it</button>
      </footer>
    </div>
  </div>

  <!-- TOASTS + ARIA LIVE -->
  <div class="toast-region" id="toast-region" aria-live="polite"></div>

  <script src="script.js" defer></script>
</body>
</html>